---
title: "M1 Part 1 Data Analysis Exercise"
format: html
---


# Load Packages and Dataset

For this assignment we must download the `dslabs` package containing the `gapminder` dataset. Loading the package and dataset will ensure that all functions and data are correctly available.

```{r}
# Load package
# install.packages("dslabs") # run once if not installed
library(dslabs)
library(ggplot2) 

# Load the dataset
data("gapminder")
```



```{r}
str(gapminder)
summary(gapminder)
class(gapminder)
```

str ( ) will show structure

summary ( ) will give descriptive stats for each variable we have

class ( ) will tell us our object type 

# Subset African Countries

```{r}
# Subset African countries
africadata <- gapminder[gapminder$continent == "Africa", ]
str(africadata)
summary(africadata)
```


The task at hand is to focus only on data from Africa. This will restrict the data for our focus subset.

---

# Subsets for Analysis

```{r}
# Subset 1: Infant Mortality & Life Expectancy
life_infant <- africadata[, c("life_expectancy", "infant_mortality")]
str(life_infant)
summary(life_infant)

# Subset 2: Population & Life Expectancy
life_pop <- africadata[, c("life_expectancy", "population")]
str(life_pop)
summary(life_pop)
```

This is to create subsets for analysis within our already designated subset of Africa. We have two specific relationships of interest.

 - Life expectancy vs. infant mortality 

 - Life expectancy vs. population

---

# Plot Life Expectancy vs Infant Mortality

```{r}
ggplot(africadata, aes(x = infant_mortality, y = life_expectancy)) +
  geom_point() +   # scatter plot points
  labs(title = "Life Expectancy vs Infant Mortality (Africa)",
       x = "Infant Mortality",
       y = "Life Expectancy") +
  theme_minimal()  # clean visual style
```

This allows us to generate a scatterplot to show the relationship between life expectancy and infant morality in African countries. 

---

# Plot Life Expectancy vs Population

```{r}
ggplot(africadata, aes(x = population, y = life_expectancy)) +
  geom_point() +               # scatter plot points
  scale_x_log10() +            # log-scale for population
  labs(title = "Life Expectancy vs Population (Africa, log scale)",
       x = "Population",
       y = "Life Expectancy") +
  theme_minimal()              # clean visual style
```

Now we can examine the relaionshio between population size and life expectancy. However, we log-scale the x-axia, 'x', due to population variability. This scaling will improve the readability of our graph visual. 

---

# Focus on the Year 2000

```{r}
year2000 <- africadata[africadata$year == 2000, ]
str(year2000)
summary(year2000)
```

Some data years have inconsistent data or missing data. Therefore, we will focus on the year 2000 for a cleaner read.

---

# Plots for Year 2000

### Life Expectancy vs Infant Mortality

```{r}
plot(year2000$infant_mortality, year2000$life_expectancy,
     xlab="Infant Mortality",
     ylab="Life Expectancy",
     main="Year 2000: Life Expectancy vs Infant Mortality",
     pch=16)
```

### Life Expectancy vs Population

```{r}
plot(year2000$population, year2000$life_expectancy,
     xlab="Population (log scale)",
     ylab="Life Expectancy",
     main="Year 2000: Life Expectancy vs Population",
     log="x", pch=16)
```

---

# Linear Models

We will use simple linear models to see if life expectancy can be predicted from infant mortality or population size in the year 2000.

```{r}
# Life Expectancy ~ Infant Mortality
fit1 <- lm(life_expectancy ~ infant_mortality, data=year2000)
summary(fit1)

# Life Expectancy ~ Population
fit2 <- lm(life_expectancy ~ population, data=year2000)
summary(fit2)
```

Life_expectancy ~ infant_mortality tells us the relationship between life expectancy and infant mortality 

life_expectancy ~ population will show the relationship between country size and life expectancy 

summary ( ) will provide our descriptive statistics

# This next section is contributed by Emil Joson

The dataset chosen for this section is *greenhouse_gases* (Greenhouse gas concentrations over 2000 years).


```{r}
#Load the dataset
data(greenhouse_gases)

#Check the dataset
str(greenhouse_gases)
summary(greenhouse_gases)
class(greenhouse_gases)
unique(greenhouse_gases$gas)
unique(greenhouse_gases$year)
```

It looks like this dataset only has three variables: year, gas, and concentrations. Specifically, this dataset contains concentration values of three greenhouse gases (carbon dioxide CO2, methane CH4 and nitrous oxide N2O) from year 20 to 2000.

```{r}
anyNA(greenhouse_gases)
```

It also looks like there aren't any missing values in this dataset.

Let's take a quick look at how these gases change over time.

```{r}
ggplot(greenhouse_gases, aes(x=year, y=concentration, group=gas))+
     geom_line(aes(color=gas))+
     theme_bw()
```

Gas concentrations seemed to have shot up at some point past 1500. Using historical context, let's take a look at the numbers only from 1760-2000 (from the beginning of the industrial revolution).


```{r}
#Subset the data from 1500-2000
greenhouse_gases1 <- greenhouse_gases[greenhouse_gases$year >= 1760 & greenhouse_gases$year <= 2000,]

#Check the subset
str(greenhouse_gases1)
summary(greenhouse_gases1)
```
The 1500-2000 subset now has 39 observations as opposed to the original dataset with 300. Let's create the same graph as before, but now using this new subset.

```{r}
ggplot(greenhouse_gases1, aes(x=year, y=concentration, group=gas))+
     geom_line(aes(color=gas))+
     theme_bw()
```

Focusing on methane, let's create a simple linear model to determine whether how its concentration was compared with time.  


```{r}
#Filter CH4 
greenhouse_gases2 <- greenhouse_gases1[greenhouse_gases1$gas == "CH4",]

#Use lm function to fit CH4 concentration as the outcome and year as the predictor
fit3 <- lm(concentration ~ year, data=greenhouse_gases2)
summary(fit3)

```  

CH4 concentration is strongly positively associated with year (3.641, p=5.93e-05). For each year that went by, CH4 concentration increased by 3.6 units.